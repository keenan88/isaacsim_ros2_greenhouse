FROM osrf/ros:humble-desktop

RUN apt-get update
RUN apt install vim -y

# Instructions for installing Moveit2 from source:
# https://moveit.ros.org/install-moveit2/source/

RUN apt install -y \
build-essential \
cmake \
git \
python3-colcon-common-extensions \
python3-flake8 \
python3-rosdep \
python3-setuptools \
python3-vcstool \
wget

RUN apt update -y
RUN apt dist-upgrade -y
RUN rosdep update -y

# These are all the packages that are installed by rosdep install --from-paths /home/moveit --ignore-src -r -y
# But since I cant run that in a dockerfile since the volumes are mounted after image build, 
# I am just manually installing all the packages here
RUN apt-get install -y ros-humble-topic-tools
RUN apt-get install -y ros-humble-ros-testing
RUN apt-get install -y ros-humble-position-controllers
RUN apt-get install -y ros-humble-google-benchmark-vendor
RUN apt-get install -y ros-humble-ament-cmake-google-benchmark
RUN apt-get install -y ros-humble-stomp
RUN apt-get install -y ros-humble-moveit-resources-pr2-description
RUN apt-get install -y ros-humble-eigen-stl-containers
RUN apt-get install -y ros-humble-geometric-shapes
RUN apt-get install -y libfcl-dev
RUN apt-get install -y ros-humble-octomap-msgs
RUN apt-get install -y ros-humble-octomap
RUN apt-get install -y ros-humble-ruckig
RUN apt-get install -y ros-humble-srdfdom
RUN apt-get install -y ros-humble-ament-clang-format
RUN apt-get install -y ros-humble-object-recognition-msgs
RUN apt-get install -y ros-humble-controller-manager
RUN apt-get install -y ros-humble-controller-manager-msgs
RUN apt-get install -y ros-humble-warehouse-ros
RUN apt-get install -y ros-humble-joint-state-publisher
RUN apt-get install -y ros-humble-launch-param-builder
RUN apt-get install -y freeglut3-dev
RUN apt-get install -y libomp-dev
RUN apt-get install -y ros-humble-joint-state-publisher-gui
RUN apt-get install -y ros-humble-ompl
RUN apt-get install -y ros-humble-gripper-controllers
RUN apt-get install -y ros-humble-joint-state-broadcaster
RUN apt-get install -y ros-humble-joint-trajectory-controller

RUN apt install gnome-terminal dbus-x11 -y

ENV ROS_DOMAIN_ID=1

# Reccomended DDS for moveit is cyclone
RUN apt install ros-$ROS_DISTRO-rmw-cyclonedds-cpp -y
ENV RMW_IMPLEMENTATION=rmw_cyclonedds_cpp

RUN echo "source /opt/ros/humble/setup.bash" >> ~/.bashrc
RUN echo "source /home/moveit/install/setup.bash" >> ~/.bashrc 